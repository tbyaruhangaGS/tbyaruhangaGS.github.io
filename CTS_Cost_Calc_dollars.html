<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cost Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.3.1/dist/pptxgen.bundle.js"></script>

    <script>

//to open the webpage- https://tbyaruhangags.github.io/CTS_Cost_Calc_dollars.html
        function safe(value) {
            return isNaN(value) ? 0 : value;
            }

        function safeRound(value) {
            return isNaN(value) ? 0 : Math.round(value);
        }
        function safeMultiply(a, b) {
            return (isNaN(a) || isNaN(b)) ? 0 : a * b;
        }
        function safeFixed(value, decimals = 2) {
            return isNaN(value) ? "0.00" : value.toFixed(decimals);
        }

        // This function will be called when the user submits the form
        function calculateCost() {


            // Get measures from the form inputs
            var av_no_mixed = parseFloat(document.getElementById('av_no_mixed').value); 
            var expansionRatePercentage = parseFloat(document.getElementById('expansionRate').value);
            var expansionRate = 1 + (isNaN(expansionRatePercentage) ? 0 : expansionRatePercentage / 100);
            var av_no_docs = parseFloat(document.getElementById('av_no_docs').value);
            var processing_in = parseFloat(document.getElementById('processing_in').value);
            var processing_blended = parseFloat(document.getElementById('processing_blended').value);
            var processing_out = parseFloat(document.getElementById('processing_out').value);
            var dedupPercentage = parseFloat(document.getElementById('dedup').value);
            var dedup = isNaN(dedupPercentage) ? 0 : dedupPercentage / 100;

  
            var dataFiltHighPercentage = parseFloat(document.getElementById('dataFiltHigh').value);
            var dataFiltLowPercentage = parseFloat(document.getElementById('dataFiltLow').value);

            var dataFiltHigh = isNaN(dataFiltHighPercentage) ? 0 : dataFiltHighPercentage / 100;
            var dataFiltLow = isNaN(dataFiltLowPercentage) ? 0 : dataFiltLowPercentage / 100;

            var userRate = parseFloat(document.getElementById('userRate').value);
            var relativityGbHostingRate = parseFloat(document.getElementById('relativityGbHostingRate').value);
            var relativityGbHostingHighRate = parseFloat(document.getElementById('relativityGbHostingHighRate').value);

            
            
            var repositoryReduction = 3;
            

            var activeLearningRate = parseFloat(document.getElementById('activeLearningRate').value);
            var airReviewRate = parseFloat(document.getElementById('airReviewRate').value);

            // Get subset percentages
            var activeLearningSubsetPercentage = parseFloat(document.getElementById('activeLearningSubset').value);
            var airReviewSubsetPercentage = parseFloat(document.getElementById('airReviewSubset').value);

            // Convert to decimals
            var activeLearningSubset = isNaN(activeLearningSubsetPercentage) ? 1 : activeLearningSubsetPercentage / 100;
            var airReviewSubset = isNaN(airReviewSubsetPercentage) ? 1 : airReviewSubsetPercentage / 100;

            
            
            


            // Input values from the form
            var custodiansValue = parseFloat(document.getElementById('custodiansValue').value);
            var projectMonths = parseFloat(document.getElementById('projectMonths').value);
            var inputVal = document.getElementById('inputValue').value;
            var isGigsSelected = document.getElementById('optionGigs').checked;
            var isDedupChecked = document.getElementById('checkboxDedup').checked;
            var isBlended = document.getElementById('checkboxBlended').checked;
            var isFilterChecked = document.getElementById('checkboxFilter').checked;
            var numUsersPerMonth = parseFloat(document.getElementById('numUsersPerMonth').value); // New input for number of users per month
            var projectDurationMonths = parseFloat(document.getElementById('projectDurationMonths').value); // New input for project duration in months

            var pmDurationMonths = parseFloat(document.getElementById('pmDurationMonths').value); // New input for project management duration in months
            var projectManagementLowHours = parseFloat(document.getElementById('projectManagementLowHours').value); // New input for project management hours per month (low estimate)
            var projectManagementHighHours = parseFloat(document.getElementById('projectManagementHighHours').value); // New input for project management hours per month (high estimate)

            var ediscAdvisoryDurationMonths = parseFloat(document.getElementById('ediscAdvisoryDurationMonths').value); //New input for ediscovery advisory duration in months
            var ediscAdvisoryLowHours = parseFloat(document.getElementById('ediscAdvisoryLowHours').value); // New input for ediscovery advisory hours per month (low estimate)
            var ediscAdvisoryHighHours = parseFloat(document.getElementById('ediscAdvisoryHighHours').value); // New input for ediscovery advisory hours per month (high estimate)

            

            // Calculations
            //var NoOfDocs = isGigsSelected ? inputVal * av_no_docs : inputVal;

            var NoOfDocs;
            if (!isNaN(custodiansValue) && custodiansValue > 0 && !isNaN(projectMonths) && projectMonths > 0) {
                // Use the new formula when custodiansValue and projectMonths are provided
                NoOfDocs = custodiansValue * projectMonths * av_no_mixed;
            } else {
                // Use the existing formula
                NoOfDocs = isGigsSelected ? inputVal * av_no_docs : inputVal;
            }

            var gigs = NoOfDocs / av_no_docs * expansionRate;
            var ExpandedNoOfDocs = NoOfDocs * expansionRate;
            var DedupedSet = ExpandedNoOfDocs - (ExpandedNoOfDocs * (isDedupChecked ? dedup : 0))

            function formatCurrency(value) {
                if (isNaN(value)) return "";
                // First, round the value to no decimal places
                let roundedValue = Math.round(value);
                // Then, format the rounded value as currency
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 0, // No decimal places
                    maximumFractionDigits: 0, // No decimal places
                }).format(roundedValue);
            }
            


            if (isBlended) {
                // Use the new formula when custodiansValue and projectMonths are provided
                processing_in = processing_blended;
                processing_out=0;
            } else {
                // Use the existing formula
                processing_blended =0;
            }

            // Processing In
            document.getElementById('dataProcessInGigs').innerText = gigs.toFixed(2);
            document.getElementById('dataProcessInCost').innerText = formatCurrency(gigs * processing_in);
            document.getElementById('processingInRateOutput').innerText = formatCurrency(processing_in)

            

            // Processing Out High
            var ReviewSetHigh = DedupedSet - (DedupedSet * (isFilterChecked ? dataFiltHigh : 0));
            var gigsHigh = ReviewSetHigh / av_no_docs;
         
            // Processing Out Low
            var ReviewSetLow = DedupedSet - (DedupedSet * (isFilterChecked ? dataFiltLow : 0));
            var gigsLow = ReviewSetLow / av_no_docs;
            document.getElementById('processingOutRateOutput').innerText = formatCurrency(processing_out)

            // After calculating gigsHigh and gigsLow and their costs
            var dataProcessOutGigsRangeText = `${gigsHigh.toFixed(2)} - ${gigsLow.toFixed(2)}`;
            var dataProcessOutCostRangeText = `${formatCurrency(gigsHigh * processing_out)}  to ${formatCurrency(gigsLow * processing_out)}`;

            document.getElementById('dataProcessOutGigsRange').innerText = dataProcessOutGigsRangeText;
            document.getElementById('dataProcessOutCostRange').innerText = dataProcessOutCostRangeText;

            // Input values for Relativity Costs
            var numUsersPerMonthOutput = parseFloat(document.getElementById('numUsersPerMonth').value);
            

            var projectDurationMonthsOutput = parseFloat(document.getElementById('projectDurationMonths').value);
         
            

            // Calculate User Fees per Month
            var totalUserFees = numUsersPerMonth * projectDurationMonths * userRate;
            document.getElementById('userRateOutput').innerText = formatCurrency(userRate);
            document.getElementById('totalUserFees').innerText =  formatCurrency(totalUserFees);

            // users/ month
            var usersPerMonthRangeText = `${safeRound(numUsersPerMonthOutput)} / ${safeRound(projectDurationMonthsOutput)}`;


            document.getElementById('usersPerMonthRangeText').innerText = usersPerMonthRangeText;


            document.getElementById('hostingRateOutput').innerText = `${formatCurrency(relativityGbHostingRate)} & ${formatCurrency(relativityGbHostingHighRate)} for GB > 1 Terabyte`;


            // Calculate Repository Hosting Fees (High Filtering)
            var repositoryHighFilt = (gigs - gigsHigh) / 3;
            
            // Calculate Repository Hosting  (Low Filtering)
            var repositoryLowFilt = (gigs - gigsLow) / 3;
            
            // Calculate Review Hosting  (High Filtering)
            var reviewHighFilt = gigsHigh + (1.25 * gigsHigh);

            // Calculate Review Hosting  (Low Filtering)
            var reviewLowFilt = gigsLow + (1.25 * gigsLow);

            var hostingLowFilt= repositoryLowFilt + reviewHighFilt
            var hostingHighFilt= repositoryHighFilt+ reviewLowFilt

            var hostingLowFees
                       
            if (hostingLowFilt > 1024) {
              
                hostingLowFiltUpTerabyte = hostingLowFilt  - 1024;
                hostingLowFeesFiltUpTerabyte = hostingLowFiltUpTerabyte  * relativityGbHostingHighRate * projectDurationMonthsOutput
                hostingLowFeesFiltDownTerabyte = 1024  * relativityGbHostingRate * projectDurationMonthsOutput;
                hostingLowFees = hostingLowFeesFiltUpTerabyte +  hostingLowFeesFiltDownTerabyte;
            } 
            else {
        
                hostingLowFees = hostingLowFilt * relativityGbHostingRate * projectDurationMonthsOutput;
            }

            var hostingHighFees
            if (hostingHighFilt > 1024) {
              
              hostingHighFiltUpTerabyte = hostingHighFilt  - 1024;
              hostingHighFeesFiltUpTerabyte = hostingHighFiltUpTerabyte  * relativityGbHostingHighRate * projectDurationMonthsOutput
              hostingHighFeesFiltDownTerabyte = 1024  * relativityGbHostingRate * projectDurationMonthsOutput;
              hostingHighFees = hostingHighFeesFiltUpTerabyte +  hostingHighFeesFiltDownTerabyte;
            } 
            else {
      
                hostingHighFees = hostingHighFilt * relativityGbHostingRate * projectDurationMonthsOutput;
            }

            // Calculate Review Active Learning
            // Calculate subset-based costs
            var reviewHighALCost = av_no_docs * gigsHigh * activeLearningRate * activeLearningSubset;
            var reviewLowALCost = av_no_docs * gigsLow * activeLearningRate * activeLearningSubset;

            // active learning range
            var reviewHighALCostRange = `${formatCurrency(reviewHighALCost)} - ${formatCurrency(reviewLowALCost)}`;

            document.getElementById('reviewHighALCostRange').innerText = reviewHighALCostRange;

            
            // Calculate Review Air Review
            var reviewHighAirReviewCost = av_no_docs * gigsHigh * airReviewRate * airReviewSubset;
            var reviewLowAirReviewCost = av_no_docs * gigsLow * airReviewRate * airReviewSubset;

            // air review range
            var reviewHighAirReviewCostRange = `${formatCurrency(reviewHighAirReviewCost)} - ${formatCurrency(reviewLowAirReviewCost)}`;

            document.getElementById('reviewHighAirReviewCostRange').innerText = reviewHighAirReviewCostRange;



            //hosting Fees and gb range
            var hostingGigsRangeText = `${hostingLowFilt.toFixed(2)} - ${hostingHighFilt.toFixed(2)}`;
            var hostingFeesRangeText = `${formatCurrency(hostingLowFees)} - ${formatCurrency(hostingHighFees)}`;

            document.getElementById('hostingGigsRangeText').innerText = hostingGigsRangeText;
            document.getElementById('hostingFeesRangeText').innerText = hostingFeesRangeText;

           

            // Calculate PM Costs
            //low costs
            var projectManagementLowHoursOutput = parseFloat(document.getElementById('projectManagementLowHours').value);
          
            var projectManagementLowMonths = parseFloat(document.getElementById('pmDurationMonths').value);

            var projectManagementMonths = parseFloat(document.getElementById('pmDurationMonths').value);
        

            var pmRate = parseFloat(document.getElementById('pmRate').value);
            var projectManagementLowCost = projectManagementLowHoursOutput * projectManagementLowMonths * pmRate;
           
            document.getElementById('pmRateOutput').innerText = formatCurrency(pmRate)

            //high costs
            var projectManagementHighHoursOutput = parseFloat(document.getElementById('projectManagementHighHours').value);
           

            var projectManagementHighMonths = parseFloat(document.getElementById('pmDurationMonths').value);
          

            var projectManagementHighCost = projectManagementHighHoursOutput * projectManagementHighMonths * pmRate;
          

            // projectManagementHoursRange
            var projectManagementHoursRange = `${projectManagementLowHoursOutput.toFixed(2)*projectManagementLowMonths} to ${projectManagementHighHoursOutput.toFixed(2)*projectManagementHighMonths }`;

            document.getElementById('projectManagementHoursRange').innerText = projectManagementHoursRange;

            var projectManagementCostRange = `${formatCurrency(projectManagementLowCost)} to ${formatCurrency(projectManagementHighCost)}`;

            document.getElementById('projectManagementCostRange').innerText = projectManagementCostRange;

            


            //Calculate eDiscovery Hours
            //low costs
            var ediscAdvisoryLowHoursOutput = parseFloat(document.getElementById('ediscAdvisoryLowHours').value);
          

            var ediscAdvisoryLowMonths = parseFloat(document.getElementById('ediscAdvisoryDurationMonths').value);
           
            var ediscAdvisoryMonths = parseFloat(document.getElementById('ediscAdvisoryDurationMonths').value);

            var edRate = parseFloat(document.getElementById('edRate').value);
            var ediscAdvisoryLowCost = ediscAdvisoryLowHoursOutput * ediscAdvisoryLowMonths * edRate;
           
            document.getElementById('edRateOutput').innerText = formatCurrency(edRate)

            //high costs
            var ediscAdvisoryHighHoursOutput = parseFloat(document.getElementById('ediscAdvisoryHighHours').value);
         
            var ediscAdvisoryHighMonths = parseFloat(document.getElementById('ediscAdvisoryDurationMonths').value);
            
            var ediscAdvisoryHighCost = ediscAdvisoryHighMonths * ediscAdvisoryHighHoursOutput * edRate;
           
            // ediscAdvisoryHoursRange
            var ediscAdvisoryHoursRange = `${ediscAdvisoryLowHoursOutput.toFixed(2)*ediscAdvisoryLowMonths} to ${ediscAdvisoryHighHoursOutput.toFixed(2)*ediscAdvisoryHighMonths}`;

            document.getElementById('ediscAdvisoryHoursRange').innerText = ediscAdvisoryHoursRange;

            var ediscAdvisoryCostRange = `${formatCurrency(ediscAdvisoryLowCost)} to ${formatCurrency(ediscAdvisoryHighCost)}`;

            document.getElementById('ediscAdvisoryCostRange').innerText = ediscAdvisoryCostRange;

            //total costs
           
            var totalCostLow = safe(gigs * processing_in)
                 + safe(gigsHigh * processing_out)
                 + safe(totalUserFees)
                 + safe(hostingLowFees)
                 + safe(projectManagementLowCost)
                 + safe(ediscAdvisoryLowCost)
                 + safe(reviewHighALCost);

            var totalCostHigh = safe(gigs * processing_in)
                  + safe(gigsLow * processing_out)
                  + safe(totalUserFees)
                  + safe(hostingHighFees)
                  + safe(projectManagementHighCost)
                  + safe(ediscAdvisoryHighCost)
                  + safe(reviewLowALCost);

            // totalCostRange

            var totalCostRange = `${formatCurrency(totalCostLow)} to ${formatCurrency(totalCostHigh)}`;

            document.getElementById('totalCostRange').innerText = totalCostRange;


            //notes
            document.getElementById('dataProcessingInNotes').innerText = `Data Processing (IN, source data with a percentage expansion of ${Math.round(expansionRatePercentage)}% at a processing rate of ${formatCurrency(processing_in)} per GB). The expanded number of docs being: ${Math.round(ExpandedNoOfDocs).toLocaleString()}`;
            //document.getElementById('dataProcessingBlendedNotes').innerText = `Data Processing (BLENDED, source data with a percentage expansion of ${Math.round(expansionRate * 100)}% at a processing rate of ${formatCurrency(processing_blended)} per GB). The expanded number of docs being: ${Math.round(ExpandedNoOfDocs).toLocaleString()}`;
            document.getElementById('dataProcessingOutNotes').innerText = `Data Processing (OUT, expanded data with deduplication ${Math.round(dedupPercentage)}%) and filtering decreases. When high filtering is applied the reduction is ${Math.round(dataFiltHighPercentage)}% when low filtering is applied, the reduction is ${Math.round(dataFiltLowPercentage)}% at a processing rate of ${formatCurrency(processing_out)} per GB. The range for processed OUT number of docs being: ${Math.round(gigsHigh*av_no_docs).toLocaleString()} to ${Math.round(gigsLow*av_no_docs).toLocaleString()}`;
            document.getElementById('documentsComment').innerText = `The range for processed OUT number of docs is: ${Math.round(gigsHigh*av_no_docs).toLocaleString()} to ${Math.round(gigsLow*av_no_docs).toLocaleString()}`;
            
            //document.getElementById('activeLearningNotes').innerText = `Active Learning at rate of $${activeLearningRatePercentage} per document. The range for active docs being: ${Math.round(gigsHigh*av_no_docs).toLocaleString()} to ${Math.round(gigsLow*av_no_docs).toLocaleString()}  (lower or delete as applicable)`;
            document.getElementById('activeLearningNotes').innerText = `Active Learning at $${activeLearningRate} per document, applied to ${activeLearningSubsetPercentage}% of the review set. Document range: ${Math.round(gigsHigh * av_no_docs * activeLearningSubset).toLocaleString()} to ${Math.round(gigsLow * av_no_docs * activeLearningSubset).toLocaleString()}`;

            //document.getElementById('airReviewNotes').innerText = `Air Review at rate of £${airReviewRate} per document. The range for active docs being: ${Math.round(gigsHigh*av_no_docs).toLocaleString()} - ${Math.round(gigsLow*av_no_docs).toLocaleString()} (lower or delete as applicable)`;
            document.getElementById('airReviewNotes').innerText = `Air Review at $${airReviewRate} per document, applied to ${airReviewSubsetPercentage}% of the review set. Document range: ${Math.round(gigsHigh * av_no_docs * airReviewSubset).toLocaleString()} to ${Math.round(gigsLow * av_no_docs * airReviewSubset).toLocaleString()}`;

            document.getElementById('hostingRepoNotes').innerText = `Repository Hosting Fees (data processed IN minus the data processed OUT divided by 3 at a rate of ${formatCurrency(relativityGbHostingRate)} for GB < 1 Terabyte and a rate of ${formatCurrency(relativityGbHostingHighRate)} for GB > 1 Terabyte for ${Math.round(projectDurationMonths)} month(s) per GB)`;
            document.getElementById('hostingReviewNotes').innerText = `Review Hosting Fees (data processed OUT at a rate of ${formatCurrency(relativityGbHostingRate)} for GB < 1 Terabyte and a rate of ${formatCurrency(relativityGbHostingHighRate)} for GB> 1 Terabyte including SQL/Data Grid Expansion (25%) for ${Math.round(projectDurationMonths)} month(s) per GB)`;
            document.getElementById('userFeesNotes').innerText = `User Fees per Month (no. of users (${Math.round(numUsersPerMonth)}) multiplied by the active workspace months (${Math.round(projectDurationMonths)}) and the user rate (${formatCurrency(userRate)})`;
            document.getElementById('pmNotes').innerText = `Project management involves allocating resources for overseeing the project, with estimated monthly hours ranging from a minimum to a maximum at an estimated rate of ${formatCurrency(pmRate)}`;
            document.getElementById('edNotes').innerText = `eDiscovery Advisory involves allocating resources for consulting, with estimated monthly hours ranging from a minimum to a maximum at an estimated rate of ${formatCurrency(edRate)}`;
           

            //User Fees per Month (no. of users multiplied by the active workspace months and the user rate)
            // Prevent form from submitting which would refresh the page
            return false;
        }
        
        function exportResults() {
            // Initialize CSV content
            let csvContent = "data:text/csv;charset=utf-8,";

            // Add the header row
            csvContent += ['Service', 'Unit', 'Est Qty.', 'Rate', 'Total Cost'].join(",") + "\r\n";

            // Collect data only from the first table and add to CSV content
            // Here we use document.querySelector to select the first table and then get all its tr elements
            document.querySelector("table").querySelectorAll("tr").forEach((tr, index) => {
                if (index > 0) { // Skip header row
                    let cells = tr.querySelectorAll("td");
                    let row = Array.from(cells).map(cell => `"${cell.innerText}"`).join(",");
                    csvContent += row + "\r\n";
                }
            });

            // Create a link to download the CSV file
            var encodedUri = encodeURI(csvContent);
            var link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "Cost_Calculation_Results.csv");
            document.body.appendChild(link); // Required for FF

            // Simulate click on link to download file
            link.click();
        }




    </script>
    <style>
        /* Base styles */
        body {
            font-family: 'Nunito', sans-serif; /* Colorlib often uses sans-serif fonts like Nunito */
            background-color: #f7f8fc; /* A light gray background for a clean look */
            color: #6c757d; /* A soft dark-gray for text */
            line-height: 1.6; /* More readable line height */
            padding: 20px;
        }

        h2 {
            color: #005073; /* Dark blue color from the logo */
            text-align: center;
            margin-bottom: 30px;
        }

        form {
            background-color: #ffffff; /* White background for forms */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1); /* A subtle shadow for depth */
            margin-bottom: 20px;
        }

        input[type="submit"],
        input[type="button"] {
            background-color: #005073; /* Dark blue color from the logo */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s; /* Smooth transition for hover effect */
        }

            input[type="submit"]:hover,
            input[type="button"]:hover {
                background-color: #003e5e; /* A slightly darker blue on hover */
            }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 20px;
        }

        .grid-item {
            text-align: left; /* Align to the left for a cleaner look */
        }

        /* Table styles */
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
            text-align: left; /* Left-aligned text in tables */
        }

        table, th, td {
            border: 1px solid #dee2e6; /* Soft gray border for less contrast */
        }

        th {
            background-color: #005073; /* Dark blue background for headers */
            color: white;
            padding: 2px;
        }

        td {
            padding: 2px;
        }

        /* Updating the form styles */
        form {
            background-color: #ffffff; /* White background for forms */
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2); /* Smooth shadow for depth */
            margin: 20px 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #333333; /* Dark text for better readability */
        }

        input[type="text"],
        input[type="number"],
        input[type="submit"],
        input[type="button"],
        input[type="radio"],
        input[type="checkbox"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #cccccc; /* Light gray border */
            box-sizing: border-box; /* Box-sizing property for proper width calculation */
        }

        input[type="submit"],
        input[type="button"] {
            background-color: #005073; /* Dark blue color from the logo */
            color: white;
            border: none;
            font-size: 16px;
            font-weight: bold; /* Bold font for buttons */
            text-transform: uppercase; /* Uppercase text for buttons */
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s; /* Smooth transition for hover effect */
            display: inline-block;
            margin-right: 5px; /* Spacing between buttons */
        }

            input[type="submit"]:hover,
            input[type="button"]:hover {
                background-color: #003e5e; /* A slightly darker blue on hover */
                transform: translateY(-2px); /* Slight lift effect on hover */
            }

        input[type="radio"],
        input[type="checkbox"] {
            width: auto; /* Auto width for radio buttons and checkboxes */
        }

        /* Clearing floats */
        .clear-fix:after {
            content: "";
            display: table;
            clear: both;
        }

        /* Style updates for two-column form layout */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Two columns of equal width */
            grid-gap: 20px; /* Space between the columns */
            margin-bottom: 10px; /* Margin bottom for each row */
        }

        /* Style for full-width form elements (like submit button) */
        .form-full-width {
            grid-column: 1 / -1; /* Span across all columns */
        }

        input[type="text"],
        input[type="number"],
        input[type="submit"],
        input[type="button"],
        input[type="radio"],
        input[type="checkbox"],
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px; /* Consistent margin-bottom for all input elements */
            border-radius: 5px;
            border: 1px solid #cccccc;
        }

        /* Adjustments for labels to align with two-column layout */
        label {
            display: block;
            margin: 0 0 5px 0;
        }

        /* Custom styles for radio buttons and checkboxes */
        .custom-radio,
        .custom-checkbox {
            display: none; /* Hide the default radio button and checkbox */
        }

            .custom-radio + label,
            .custom-checkbox + label {
                position: relative;
                padding-left: 35px; /* Space for our custom checkbox/radio button */
                cursor: pointer;
                display: inline-block;
                color: #6c757d; /* Color from your existing code */
            }

                .custom-radio + label::before,
                .custom-checkbox + label::before {
                    content: '';
                    position: absolute;
                    left: 0;
                    top: 50%;
                    transform: translateY(-50%);
                    width: 20px;
                    height: 20px;
                    border: 2px solid #005073; /* Dark blue border color */
                    border-radius: 50%; /* Round border for radio buttons, set to 0 for checkboxes */
                    background-color: #f7f8fc; /* Background color */
                }

                .custom-checkbox + label::before {
                    border-radius: 5px; /* Less round borders for checkboxes */
                }

            /* Style when radio button/checkbox is checked */
            .custom-radio:checked + label::after,
            .custom-checkbox:checked + label::after {
                content: '';
                position: absolute;
                left: 5px;
                top: 50%;
                transform: translateY(-50%);
                width: 14px;
                height: 14px;
                border-radius: 50%; /* Round for radio buttons, set to 0 for checkboxes */
                background-color: #005073; /* Dark blue color */
            }

            .custom-checkbox:checked + label::after {
                width: 10px;
                height: 10px;
                border-radius: 2px; /* Less round for checkboxes */
                left: 6px; /* Center the check mark */
                background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23fff"><path d="M20.285,7.291l-11,11c-0.392,0.391-1.023,0.391-1.414,0l-5-5c-0.391-0.391-0.391-1.023,0-1.414s1.023-0.391,1.414,0 l3.291,3.291l9.292-9.292c0.391-0.391,1.023-0.391,1.414,0S20.676,6.9,20.285,7.291z"/></svg>'); /* Checkmark icon */
                background-size: cover;
                background-position: center;
                background-repeat: no-repeat;
            }

        .custom-button {
            background-color: #005073; /* Dark blue color from the logo */
            color: white;
            border: none;
            font-size: 16px;
            font-weight: bold; /* Bold font for buttons */
            text-transform: uppercase; /* Uppercase text for buttons */
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s; /* Smooth transition for hover effect */
            display: inline-block;
            margin-right: 5px; /* Spacing between buttons */
            padding: 10px 20px; /* Padding for buttons */
            border-radius: 5px; /* Rounded corners */
        }

            .custom-button:hover {
                background-color: #003e5e; /* A slightly darker blue on hover */
                transform: translateY(-2px); /* Slight lift effect on hover */
            }


        /* CSS for the buttons */
        .custom-button-container {
            text-align: center; /* Centers the buttons */
            margin-top: 20px; /* Adds some space above the buttons */
        }

        .custom-button {
            background-color: #005073; /* Example button color */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 5px; /* Adds space between buttons */
            /* Additional button styling */
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: center;
        }

        .logo {
            width: 200px;
            align-self: flex-start; /* Aligns the logo to the start of the flex container */
        }
        /* Styles for the forms container */
        .forms-container {
            display: flex; /* Use Flexbox to arrange forms side by side */
            justify-content: space-between; /* Space between the forms */
        }

        .form-half {
            width: 48%; /* Each form takes up less than half of the container's width to fit side by side */
            /* Other styling as needed */
            margin: 0 20px;
        }
        

        
        /* Additional responsive adjustments */
        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: 1fr; /* Full width on smaller screens */
            }

            .forms-container {
                flex-direction: column; /* Stack forms vertically on smaller screens */
            }

            .form-half {
                width: 100%; /* Each form takes full width on smaller screens */
                margin: 10px 0;
            }
            .tables-container table {
                width: 100%; /* Full width on smaller screens */
                margin-bottom: 10px; /* Adds spacing below each table when stacked */
            }
        }

        /* Table styles adjustments for consistency */
        .tables-container {
            display: flex;
            justify-content: space-between; /* Ensures there is space between the two tables */
            flex-wrap: wrap; /* Allows tables to wrap on smaller screens */
        }

        .tables-container table:first-child {
            width: calc(65% - 10px); /* Allocates 70% of the width to the first table, adjusting for margin */
            margin-right: 10px; /* Adds spacing between the two tables */
        }

        .tables-container table:last-child {
            width: calc(35% - 10px); /* Allocates 30% of the width to the second table, adjusting for margin */
        }
        
        /* Styles for the second table to have smaller font size */
        .tables-container table:last-child, 
        .tables-container table:last-child th, 
        .tables-container table:last-child td {
            font-size: 12px; /* Adjust the font size as needed */
            text-align: left;
        }
        table, th, td {
            border: 1px solid #005073; /* Using the primary color for the table border */
        }

        th {
            background-color: #005073; /* Primary color background for headers */
            color: white;
            padding: 5px;
        }

        td {
            padding: 5px;
            text-align: center;
        }
        #firstTable, #firstTable th, #firstTable td {
            font-size: 13px;
        }
        .commentColumn {
            font-size: 12px; /* Smaller font size for comments */
            padding: 2px;
            text-align: left;
            width: 25%;
        }


    </style>
</head>
<body>
<div class="container clear-fix">
    <div class="header-container">
        <img src="https://gravitystack.com/wp-content/uploads/2024/05/logo-black.png" alt="Gravity Stack Logo" class="logo" style="align-self: flex-start; width: 230px;">
        <div>
            <h2>CTS eDiscovery Cost Calculator</h2>
        </div>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Reed_Smith_Logo.svg/500px-Reed_Smith_Logo.svg.png" alt="Second Logo" class="logo" style="align-self: flex-end; margin-bottom: 40px; width: 170px;">
    </div>

   
            <div class="forms-container">
                <div class="forms-container">
                <form id="inputForm" class="form">
                    <h2>Data Processing</h2>
                    <h5>Please fill in the values below and select calculate to work out the data processed in and out in the table below</h5>
                    <h5>Some values are predetermined but they can be customised for specific use cases.</h5><br>
                    <h3>Data Processing Option 1</h3>
                    <h5>If the number of custodians and project duration is unknown, please enter the data volume</h5>
                    
                    <div class="form-row">
                        <div>
                            <label for="custodiansValue">Number of Custodians:</label>
                            <input type="number" id="custodiansValue" name="custodiansValue">

                        </div>
                        <div>
                            <label for="projectMonths">Duration of Data Collection (Months):</label>
                            <input type="number" id="projectMonths" name="projectMonths">

                        </div>
                        
                        <div>
                            <label for="av_no_mixed">Average no. of docs per custodian per month:</label>

                            <input type="number" id="av_no_mixed" name="av_no_mixed" value="2500">

                        </div>
                        <h5>Recommended Average no. of docs for x custodians across x months:(mixed docs- 2,500, emails- 5,000)</h5>
                    </br>
                        
                    </div>
                    <h3>Data Processing Option 2</h3>
                    <h5>Please leave the data volume and gigs or doc count section blank if number of custodians and project duration known</h5>
                    <div class="form-row">
                        <div>
                            <label for="inputValue">Enter Data Volume:</label>
                            <input type="text" id="inputValue" name="inputValue">

                        </div>
                        <div>
                            <br />
                            <input type="radio" id="optionGigs" class="custom-radio" name="dataType" value="gigs">
                            <label for="optionGigs">Gigs</label>
                            <br />
                            <input type="radio" id="optionDocs" class="custom-radio" name="dataType" value="docs">
                            <label for="optionDocs">Doc Count</label>
                            
                       </div>
                        
                        
                        </div>

                        <h5>Recommended Average No. of Docs Per Gig (low- 2,500, medium- 3,500 and high- 5,000)</h5>
                          
                        <div class="form-row">
                            <div>
                            <label for="av_no_docs">Average No. of Docs Per Gig:</label>
                            <input type="number" id="av_no_docs" name="av_no_docs" value="5000">
                        </div>
                        <div>
                            <label for="expansionRate">Expansion Rate (%):</label>
                          
                            <input type="number" id="expansionRate" name="expansionRate" step="1" value="75">
                        </div>
                        </div>
                        <div>
                           
                            <input type="checkbox" id="checkboxBlended" class="custom-checkbox" name="blended">
                            <label for="checkboxBlended">Blended</label>

                        </div>
                        <div class="form-row">
                        <div>
                            <label for="processing_in">Processing In ($/GB):</label>
                            <input type="number" id="processing_in" name="processing_in" step="0.01" value="25">
                        </div>
                        <div>
                            <label for="processing_out">Processing Out ($/GB):</label>
                            <input type="number" id="processing_out" name="processing_out" step="0.01" value="95">
                        </div>
                        <div>
                            <label for="processing_blended">Processing Blended ($/GB):</label>
                            <input type="number" id="processing_blended" name="processing_blended" step="0.01" value="55">
                        </div>
                    </div>
                   
                    <br>
                    <h2>Data Filtering</h2>
                    <h5>Please indicate if you'll be applying deduplication and filtering to the processed data</h5>
                    <div class="form-row">

                        <div>
                            <input type="checkbox" id="checkboxDedup" class="custom-checkbox" name="dedup">
                            <label for="checkboxDedup">Deduplication</label>
                            <input type="checkbox" id="checkboxFilter" class="custom-checkbox" name="filter">
                            <label for="checkboxFilter">Data Filtering</label>

                            
                        </div>
                        
                    </div>
                    <h6><i>(data filtering applies a high and low filtering range considering email threading and keywords)</i></h6>
                    <div class="form-row">
                        <div>
                            <label for="dedup">Deduplication Rate (%):</label>
                            <input type="number" id="dedup" name="dedup" step="1" value="20">
                        </div>
                       
                    </div>
                    <div class="form-row">
                        <div>
                            <label for="dataFiltHigh">High Filtering Rate (%):</label>
                            <input type="number" id="dataFiltHigh" name="dataFiltHigh" step="1" value="70">
                        </div>
                        <div>
                            <label for="dataFiltLow">Low Filtering Rate (%):</label>
                            <input type="number" id="dataFiltLow" name="dataFiltLow" step="1" value="20">
                        </div>
                        
                    </div>
                    <br>
                    <h2>Relativity Users</h2>
                    
                    <div class="form-row">
                        <div>
                            <label for="numUsersPerMonth">Number of Relativity Users per Month:</label>
                            <input type="number" id="numUsersPerMonth" name="numUsersPerMonth">
                        </div>
                        
                        <div>
                            <label for="userRate">Relativity User Rate (£/Month/User):</label>
                            <input type="number" id="userRate" name="userRate" value="75">
                        </div>
                    </div>

                    <br>
                    <h2>Relativity Hosting Costs</h2>
                    
                    <div class="form-row">
                        
                        <div>
                            <label for="relativityGbHostingRate">Relativity GB Hosting Rate ($/Month/GB):</label>
                           
                            <input type="number" id="relativityGbHostingRate" name="relativityGbHostingRate" value="9">
                        </div>
                        <div>
                            <label for="relativityGbHostingHighRate">Relativity GB Hosting Rate > 1 Terabyte ($/Month/GB):</label>
                            <input type="number" id="relativityGbHostingHighRate" name="relativityGbHostingHighRate" value="7">
                        </div>
                        
                        <div>
                            <label for="projectDurationMonths">Relativity Active Date Period (Months):</label>
                            <input type="number" id="projectDurationMonths" name="projectDurationMonths">
                        </div>
                        
                    </div>
                <div class="custom-button-container">
                <button type="button" onclick="calculateCost()" class="custom-button">Calculate Current Doc Range</button>
                
                </div>

                    <br>
                    <h2>Relativity Reviews</h2>
                    <h5 id="documentsComment"></h5>
                    <div class="form-row">
                        
                        
                        <div>
                            <label for="activeLearningRate">Active Learning Rate (per doc):</label>
                            
                            <input type="number" id="activeLearningRate" name="activeLearningRate" step="0.01" value="0.02">
                        </div>

                        <div>
                            <label for="activeLearningSubset">Active Learning % of Review Set:</label>
                            <input type="number" id="activeLearningSubset" name="activeLearningSubset" step="1" value="100">
                        </div>
                        
                        <div>
                            <label for="airReviewRate">Air for Review Rate (per doc):</label>

                            <input type="number" id="airReviewRate" name="airReviewRate" step="0.2" value="0.25">
                        </div>

                        <div>
                            <label for="airReviewSubset">Air for Review % of Review Set:</label>
                            <input type="number" id="airReviewSubset" name="airReviewSubset" step="1" value="100">
                        </div>
                       
                    </div>



                    <br>
                    <h2>Billable Time</h2>
                    <h5>Please fill in the values below to work out the time associated with project management and eDiscovery.</h5>
                    <div class="form-row">
                        <div>
                            <label for="pmRate">Project Management Rate ($/Month):</label>
                            <input type="number" id="pmRate" name="pmRate" value="450">
                        </div>

                        <div>
                            <label for="pmDurationMonths">Project Management Time (Months):</label>
                            <input type="text" id="pmDurationMonths" name="pmDurationMonths">
                        </div>

                   

                        <div>
                            <label for="projectManagementLowHours">Project Management Hours/ Month (low estimate):</label>
                            <input type="number" id="projectManagementLowHours" name="projectManagementLowHours">
                        </div>
                        <div>
                            <label for="projectManagementHighHours">Project Management Hours/ Month (high estimate):</label>
                            <input type="number" id="projectManagementHighHours" name="projectManagementHighHours">
                        </div>

                        <br><br>
                        <div>
                            <label for="edRate">eDiscovery Advisory Rate ($/Month):</label>
                            <input type="number" id="edRate" name="edRate" value="550">
                        </div>

                        <div>
                            <label for="ediscAdvisoryDurationMonths">eDiscovery Advisory Time (Months):</label>
                            <input type="number" id="ediscAdvisoryDurationMonths" name="ediscAdvisoryDurationMonths">
                        </div>
                    
                        <div>
                            <label for="ediscAdvisoryLowHours">eDiscovery Advisory Hours/ Month (low estimate):</label>
                            <input type="number" id="ediscAdvisoryLowHours" name="ediscAdvisoryLowHours">
                        </div>
                        <div>
                            <label for="ediscAdvisoryHighHours">eDiscovery Advisory Hours/ Month (high estimate):</label>
                            <input type="number" id="ediscAdvisoryHighHours" name="ediscAdvisoryHighHours">
                        </div>
                    </div>
                </form>

                
            </div>

                
            </div>
            <!-- Buttons placed outside the forms but within the container for a unified action -->
            <div class="custom-button-container">
                <button type="button" onclick="calculateCost()" class="custom-button">Calculate</button>
                
                <button type="button" onclick="exportResults()" class="custom-button" id="exportBtn">Export</button>
            </div>
       
            <!-- <div  class="tables-container">  -->
        <!-- Script and additional content follows -->
        <!-- Existing table -->
            <table border="1">
                <tr>
                    <th>Service</th>
                    <th>Unit</th>
                    <th>Est Qty.</th>
                    <th>Rate</th>
                    <th>Total Cost</th>
                    <th>Comments</th>
                </tr>
                <tr>
                    <td>Data Processing (IN)</td>
                    <td>Per GB</td>
                    <td id="dataProcessInGigs"></td>
                    <td id="processingInRateOutput"></td>
                    <td id="dataProcessInCost"></td>
                    <td id="dataProcessingInNotes" class="commentColumn"></td>
                </tr>
                <tr>
                    <td>Data Processing (OUT)</td>
                    <td>Per GB</td>
                    <td id="dataProcessOutGigsRange"></td>
                    <td id="processingOutRateOutput"></td>
                    <td id="dataProcessOutCostRange"></td>
                    <td id="dataProcessingOutNotes" class="commentColumn"></td>
                </tr>

               

                <!-- New table for Relativity Costs -->


                <tr>
                    <td>Hosting</td>
                    <td>GB/Month</td>
                    <td id="hostingGigsRangeText"></td>
                    <td id="hostingRateOutput"></td>
                    <td id="hostingFeesRangeText"></td>
                    <td class="commentColumn">
                        <p id="hostingRepoNotes"></p>
                        <p id="hostingReviewNotes"></p>
                      
                    
                    
                    </td>
                </tr>

                <tr>
                    <td>Active Learning</td>
                    <td>Per Document</td>
                    <td></td>
                    <td></td>
                    <td id="reviewHighALCostRange"></td>
                    <td id="activeLearningNotes" class="commentColumn"></td>
                </tr>
                <tr>
                    <td>Air for Review</td>
                    <td>Per Document</td>
                    <td></td>
                    <td></td>
                    <td id="reviewHighAirReviewCostRange"></td>
                    <td id="airReviewNotes" class="commentColumn"></td>
                </tr>
                <tr>
                    <td>User Fees</td>
                    <td>Users/Month</td>
                    <td id="usersPerMonthRangeText"></td>
                    <td id="userRateOutput"></td>
                    <td id="totalUserFees"></td>
                    <td id="userFeesNotes" class="commentColumn"></td>
                </tr>
                <!-- New table for Time Costs -->

                <tr>
                    <td>Project Management</td>
                    <td>Hourly</td>
                    <td id="projectManagementHoursRange"></td>
                    <td id="pmRateOutput"></td>
                    <td id="projectManagementCostRange"></td>
                    <td id="pmNotes" class="commentColumn"></td>
                </tr>

                <tr>
                    <td>eDiscovery Advisory</td>
                    <td>Hourly</td>
                    <td id="ediscAdvisoryHoursRange"></td>
                    <td id="edRateOutput"></td>
                    <td id="ediscAdvisoryCostRange"></td>
                    <td id="edNotes" class="commentColumn"></td>

                </tr>


                <tr>
                    <td><b>Estimated Project Total Range:</b></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td id="totalCostRange"></td>
                    <td></td>
                </tr>


            </table>

            

        <!-- </div> -->
</div>
</body>
</html>




